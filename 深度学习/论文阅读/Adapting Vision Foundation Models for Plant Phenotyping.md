# 1.摘要
基础模型是在大量数据上进行预训练的大型模型。它们通常可以轻松适应各种下游任务。<font color="green">然而，由于基础模型通常是在互联网上获取的图像或文本上进行预训练的，因此它们在专业领域（如植物表型）中的性能受到质疑。</font>此外，完全微调基础模型需要耗费时间且需要高计算能力。本文研究了将基础模型有效地适应于植物表型设置和任务。我们对三个基础模型（MAE、DINO和DINOv2）进行了广泛实验，<font color="green">在三个重要的植物表型任务（叶片计数、实例分割和病害分类）上进行了微调</font>。特别地，预训练骨干网络保持冻结状态，同时评估了两种不同的微调方法：<font color="green">适配器微调（使用LoRA）和解码器微调。实验结果显示，一个基础模型可以高效地适应多个植物表型任务，并产生与针对每个任务专门设计或训练的最先进（SoTA）模型相似的性能。</font>尽管在某些情况下经过精调的基础模型比SoTA特定任务模型稍差，但这需要进一步研究。
# 2.介绍
植物表型学旨在定量评估植物的结构和功能属性，这对现代农业的多个领域至关重要，如作物改良、病虫害管理和气候适应性[50]。在过去十年中，深度学习已成为不同植物表型任务中的重要工具，例如叶片计数和分割[14, 17, 20]、根部分割[44, 49]、小麦穗位定位[7, 40]以及疾病分类[41, 42]。
然而，这些模型中的大多数都具有特定任务的架构设计：虽然它们在执行其设计或训练的任务时表现出色，但在应用于其他任务时性能下降。这种缺乏通用性使得深度学习模型的实施（和部署）效率低下，因为需要为每个特定任务设计、开发和训练新模型。最近对基础模型[4]的发展是解决植物表型研究社区面临问题的一个有希望的途径。
基础模型是具有大量可训练参数并在广泛而多样的数据集上进行预训练的模型，具有轻松适应各种未见任务的潜力[4]。其中一个著名的基础模型是ChatGPT[5]，这是一个大型语言基础模型，使用自回归语言建模（即，在给定先前所有单词的情况下预测句子中的下一个单词）在大量互联网数据上进行预训练。ChatGPT在执行未经过训练的新任务方面表现出了卓越的多功能性，如编程和翻译。在计算机视觉领域，一个最近的基础模型示例是Segment Anything Model（SAM）[31]。SAM在一个名为SA1B的庞大数据集上进行了预训练，该数据集包含1100万张图像，补充了10亿个掩模标签，以执行提示的图像分割任务。这两个最近的例子展示了基础模型的灵活性和广泛适用性，涵盖了从自然语言处理到计算机视觉的多个领域。
尽管基础模型具有一些优势，但这些模型存在两个主要限制。首先，基础模型通常是在通用领域数据上训练的，缺乏专业和领域特定的知识。当基础模型应用于与通用上下文和应用不同的领域时，例如医学影像、工业检查和农业[24, 28, 29]，这种限制就变得明显。在新数据和任务上对基础模型进行微调有望缓解领域转移的影响。然而，这带来了第二个限制：基础模型庞大而复杂。由于其拥有数十亿个可训练参数，微调这样庞大的模型是耗时的，并且需要硬件基础设施，这对于大多数专业领域的用户来说是难以承受的。
相反，仅调整特定任务的解码器，比如用于图像分类的线性层，同时冻结模型的其余部分，使得将大型模型转移到新任务更为可行。然而，解码器调整可能导致次优性能[16, 19]。近年来，<font color="red">对参数高效微调（PEFT）</font> 概念的兴趣日益增长，将其作为在调整成本和性能之间取得平衡的解决方案[34]。与解码器调整不同，PEFT对模型骨干中的一小部分参数进行微调，而骨干的大多数参数保持不变[13]。适配器是PEFT家族中的重要成员，它们是新集成的可训练模块，适应于预训练模型的各个层之间[25]。这些模块强大而高效，提供了与全面微调相媲美的性能，同时显著降低了计算成本[9, 10, 27]。因此，适配器为高效微调基础模型以适应未见情景和任务提供了一种折中方案，同时保留了它们的灵活性。
为了缓解单独开发特定任务模型的乏味和费用，本研究的主要目标是回答一个问题：通过高效微调预训练的基础模型，是否能够解决多样的植物表型任务？为了回答这个问题，我们专注于基于视觉变换器（Vision Transformer，ViT）[15]的三个领先的基础模型：Masked Autoencoders（MAE）[21]、DINO [6]和DINOv2 [38]。我们进行了广泛的实验证明，通过使用解码器调整和一个流行的适配器——低秩适应（Low-Rank Adaptation，LoRA）[27]，对这些模型进行微调的性能。实验涉及与植物表型相关的任务，包括叶片计数、实例分割和病害分类。图1总结了本研究的方法论。我们实验中使用的数据集是多样化的，来自受控和野外环境，这使我们能够在各种条件下探讨基础模型的有效性和适应性。本工作的主要贡献包括：
1. <font color="blue">据我们所知，本研究是首次调查基础模型（使用LoRA）在多样的植物表型任务上的适应性。</font> 我们的实验工作为对这些先进方法的关键评估做出了贡献，并在该领域建立了有价值的基准。
2. 我们还研究了在考虑的植物表型应用中基础模型更适用的情况。通过识别和理解局限性，我们的研究提供了对未来发展植物表型基础模型的关键见解，可以指导未来的研究方向。
![](img/CleanShot%202023-11-23%20at%2010.42.52@2x.png)